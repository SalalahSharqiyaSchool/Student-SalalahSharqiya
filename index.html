<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>بوابة صلالة الشرقية للتميز الرقمي</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Almarai:wght@300;400;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <style>
        :root {
            --deep-emerald: #04241f; /* أخضر زيتي غامق جداً */
            --emerald-light: #0a4d44;
            --gold-burnished: #af9164; /* ذهبي مطفي فخم */
            --gold-bright: #e3c08d;
            --glass-white: rgba(255, 255, 255, 0.05);
            --border-glow: rgba(175, 145, 100, 0.2);
        }

        body {
            font-family: 'Almarai', sans-serif;
            margin: 0;
            background: var(--deep-emerald);
            /* تدرج إضاءة خلفي هادئ */
            background-image: 
                radial-gradient(circle at 50% -20%, var(--emerald-light), transparent 70%),
                url("data:image/svg+xml,%3Csvg width='52' height='26' viewBox='0 0 52 26' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23af9164' fill-opacity='0.03'%3E%3Cpath d='M10 10c0-2.21-1.79-4-4-4-3.314 0-6-2.686-6-6h2c0 2.21 1.79 4 4 4 3.314 0 6 2.686 6 6 0 2.21 1.79 4 4 4h2c-2.21 0-4-1.79-4-4z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        header {
            padding: 25px 8%;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid var(--border-glow);
            background: rgba(4, 36, 31, 0.8);
            backdrop-filter: blur(15px);
        }

        .container { max-width: 1000px; margin: 60px auto; padding: 0 25px; }

        /* --- واجهة البحث (Cinema Style) --- */
        .hero-gate {
            text-align: center;
            padding: 80px 40px;
            background: var(--glass-white);
            border-radius: 50px;
            border: 1px solid var(--border-glow);
            box-shadow: 0 40px 80px rgba(0,0,0,0.5);
            position: relative;
        }

        .hero-gate i.main-icon {
            font-size: 5rem; color: var(--gold-burnished);
            filter: drop-shadow(0 0 15px rgba(175, 145, 100, 0.4));
            margin-bottom: 30px;
        }

        .hero-gate h2 { font-size: 2.5rem; font-weight: 800; margin-bottom: 10px; }
        .hero-gate p { color: #a0afad; font-size: 1.1rem; margin-bottom: 40px; }

        .search-box {
            position: relative; max-width: 450px; margin: 0 auto;
        }

        .search-box input {
            width: 100%; padding: 22px; border-radius: 20px;
            border: 2px solid var(--border-glow); background: rgba(0,0,0,0.3);
            color: #fff; font-size: 1.4rem; text-align: center; outline: none;
            transition: 0.4s;
        }

        .search-box input:focus {
            border-color: var(--gold-burnished);
            box-shadow: 0 0 30px rgba(175, 145, 100, 0.2);
            background: rgba(0,0,0,0.5);
        }

        /* --- كشف الدرجات (Official Layout) --- */
        .report-card {
            background: #fff; color: #333;
            border-radius: 0; padding: 50px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            position: relative; border: 12px double var(--gold-burnished);
        }

        .report-header {
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 2px solid var(--deep-emerald); padding-bottom: 20px; margin-bottom: 30px;
        }

        .student-meta {
            display: grid; grid-template-columns: 1fr 1fr; gap: 20px;
            background: #f9f9f9; padding: 20px; border-radius: 10px; margin-bottom: 30px;
        }

        .meta-item { font-size: 1.1rem; }
        .meta-item b { color: var(--emerald-light); }

        .grades-table { width: 100%; border-collapse: collapse; }
        .grades-table th { background: var(--deep-emerald); color: var(--gold-bright); padding: 15px; text-align: right; }
        .grades-table td { padding: 15px; border-bottom: 1px solid #eee; font-weight: bold; }

        /* --- الأزرار الموحدة --- */
        .btn-premium {
            background: linear-gradient(135deg, var(--gold-burnished), #8e6d2e);
            color: #fff; border: none; padding: 18px 50px; border-radius: 15px;
            font-size: 1.2rem; font-weight: 800; cursor: pointer; transition: 0.3s;
            display: inline-flex; align-items: center; gap: 10px;
        }

        .btn-premium:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0,0,0,0.3); }

        .btn-secondary {
            background: transparent; border: 2px solid var(--gold-burnished); color: var(--gold-burnished);
            padding: 15px 40px; border-radius: 15px; cursor: pointer; font-weight: 700;
        }

        .view-section { display: none; }
        .view-section.active { display: block; animation: fadeInUp 0.6s ease-out; }

        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

        @media print {
            body { background: white !important; padding: 0; }
            .no-print { display: none !important; }
            .report-card { box-shadow: none; border: 8px double #af9164; margin: 0; width: 100%; }
            .container { margin: 0; max-width: 100%; }
        }
    </style>
</head>
<body>

<header class="no-print">
    <div style="display: flex; align-items: center; gap: 15px;">
        <img src="logo.png" style="height: 60px;">
        <div>
            <h1 style="margin: 0; font-size: 1.2rem; color: var(--gold-bright);">بوابة مدرسة صلالة الشرقية</h1>
            <span style="font-size: 0.8rem; color: var(--gold-burnished); opacity: 0.8;">التحول الرقمي التعليمي</span>
        </div>
    </div>
</header>

<div class="container">
    
    <section id="searchView" class="view-section active">
        <div class="hero-gate">
            <i class="fa-solid fa-medal main-icon"></i>
            <h2>مرحباً بك في بوابة النتائج</h2>
            <p>يرجى إدخال الرقم المدني الخاص بالطالب لاستعراض الشهادة الرسمية</p>
            
            <div class="search-box">
                <input type="text" id="civilInput" placeholder="00000000" maxlength="8">
            </div>
            
            <div style="margin-top: 40px;">
                <button class="btn-premium" onclick="executeProcess()">
                    استخراج الكشف <i class="fa-solid fa-chevron-left"></i>
                </button>
            </div>
        </div>
    </section>

    <section id="resultView" class="view-section">
        <div class="report-card" id="printableReport">
            <div class="report-header">
                <div style="text-align: right; font-size: 0.9rem;">
                    سلطنة عمان<br>وزارة التربية والتعليم<br><b>مدرسة صلالة الشرقية (5-10)</b>
                </div>
                <img src="logo.png" style="height: 90px;">
                <div style="text-align: left; font-size: 0.9rem;">
                    العام الدراسي: 2025/2026 م<br>تقرير الأداء الأكاديمي للطلاب
                </div>
            </div>

            <div class="student-meta">
                <div class="meta-item">اسم الطالب: <b id="outName">-</b></div>
                <div class="meta-item">الرقم المدني: <b id="outCivil">-</b></div>
                <div class="meta-item">الصف الدراسي: <b id="outGrade">-</b></div>
                <div class="meta-item">الشعبة: <b id="outClass">-</b></div>
            </div>

            <table class="grades-table">
                <thead>
                    <tr>
                        <th>المادة الدراسية</th>
                        <th style="text-align: center;">الدرجة (100)</th>
                        <th style="text-align: center;">التقدير العام</th>
                    </tr>
                </thead>
                <tbody id="outTableBody"></tbody>
            </table>

            <div style="margin-top: 40px; display: flex; justify-content: space-between; align-items: flex-end;">
                <div style="font-size: 0.8rem; color: #666;">* ملاحظة: صدرت هذه الشهادة إلكترونياً من بوابة المدرسة.</div>
                <div style="text-align: center;">
                    <p style="margin-bottom: 40px;">إدارة المدرسة</p>
                    <div style="font-family: 'Times New Roman'; font-style: italic; opacity: 0.5;">(ختم وتوقيع إلكتروني)</div>
                </div>
            </div>
        </div>

        <div class="no-print" style="text-align: center; margin-top: 30px; display: flex; justify-content: center; gap: 20px;">
            <button class="btn-premium" onclick="window.print()">
                <i class="fa-solid fa-print"></i> طباعة كشف الدرجات
            </button>
            <button class="btn-secondary" onclick="location.reload()">
                <i class="fa-solid fa-rotate-right"></i> استعلام جديد
            </button>
        </div>
    </section>
</div>

<script>
    async function executeProcess() {
        const civil = document.getElementById('civilInput').value.trim();
        if(!civil) return;

        const files = ["grade5.json", "grade6.json", "grade7.json", "grade8.json", "grade9.json"];
        let dataFound = null;

        for(let f of files) {
            try {
                const res = await fetch(f + "?v=" + Date.now());
                const data = await res.json();
                dataFound = data.find(s => s["رقم_مدني"].toString() === civil);
                if(dataFound) break;
            } catch(e) {}
        }

        if(dataFound) {
            renderData(dataFound);
        } else {
            alert("لم يتم العثور على بيانات للرقم المدني المدخل.");
        }
    }

    function renderData(s) {
        document.getElementById('outName').innerText = s["الاسم"];
        document.getElementById('outCivil').innerText = s["رقم_مدني"];
        document.getElementById('outGrade').innerText = s["الصف"];
        document.getElementById('outClass').innerText = s["الشعبة"];

        const subjects = Object.keys(s).filter(k => !["رقم_مدني", "الاسم", "الصف", "الشعبة"].includes(k));
        let html = '';
        subjects.forEach(sub => {
            const v = parseFloat(s[sub]);
            html += `<tr>
                <td>${sub}</td>
                <td style="text-align:center; font-size:1.2rem;">${v}</td>
                <td style="text-align:center;">${v >= 90 ? 'ممتاز' : v >= 80 ? 'جيد جداً' : v >= 50 ? 'مقبول' : 'ضعيف'}</td>
            </tr>`;
        });

        document.getElementById('outTableBody').innerHTML = html;
        document.getElementById('searchView').classList.remove('active');
        document.getElementById('resultView').classList.add('active');
    }
</script>

</body>
</html>
