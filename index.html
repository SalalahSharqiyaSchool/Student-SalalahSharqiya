<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø¨ÙˆØ§Ø¨Ø© ØµÙ„Ø§Ù„Ø© Ø§Ù„Ø´Ø±Ù‚ÙŠØ© Ø§Ù„Ø±Ù‚Ù…ÙŠØ© | 2026</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Kufi+Arabic:wght@300;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <style>
        :root {
            --emerald-deep: #004d40; /* Ø£Ø®Ø¶Ø± Ø²Ù…Ø±Ø¯ÙŠ Ø¹Ù…ÙŠÙ‚ */
            --emerald-light: #00796b;
            --navy-dark: #102a43; /* Ø£Ø²Ø±Ù‚ Ø¨Ø­Ø±ÙŠ ÙˆÙ‚ÙˆØ± */
            --gold-muted: #af9164; /* Ø°Ù‡Ø¨ÙŠ Ù…Ø·ÙÙŠ */
            --off-white: #f8fafc;
            --glass: rgba(255, 255, 255, 0.95);
            --shadow: 0 15px 35px rgba(0, 0, 0, 0.05);
        }

        body {
            font-family: 'Noto Kufi Arabic', sans-serif;
            margin: 0;
            background-color: var(--off-white);
            color: var(--navy-dark);
            background-image: linear-gradient(135deg, #e2e8f0 0%, #f8fafc 100%);
            min-height: 100vh;
        }

        /* --- Navbar Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© --- */
        nav {
            background: var(--glass);
            backdrop-filter: blur(15px);
            padding: 1rem 8%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 3px solid var(--emerald-deep);
            box-shadow: var(--shadow);
            position: sticky; top: 0; z-index: 1000;
        }
        .nav-logo { display: flex; align-items: center; gap: 15px; }
        .nav-logo img { height: 65px; border-radius: 10px; }
        .nav-title h1 { font-size: 1.3rem; margin: 0; color: var(--emerald-deep); font-weight: 900; }
        .nav-title span { font-size: 0.8rem; color: var(--gold-muted); font-weight: 700; text-transform: uppercase; }

        .container { max-width: 1200px; margin: 50px auto; padding: 0 25px; }
        .view { display: none; }
        .view.active { display: block; animation: slideIn 0.7s cubic-bezier(0.23, 1, 0.32, 1); }

        @keyframes slideIn {
            from { opacity: 0; transform: scale(0.98) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        /* --- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¨Ø­Ø« (Minimal & Bold) --- */
        .search-hero {
            background: white;
            border-radius: 40px;
            padding: 80px 40px;
            text-align: center;
            box-shadow: var(--shadow);
            border: 1px solid rgba(0, 77, 64, 0.05);
        }
        .search-hero h2 { font-size: 2.2rem; margin-bottom: 15px; color: var(--navy-dark); }
        .search-hero p { color: #64748b; margin-bottom: 40px; font-size: 1.1rem; }

        .input-group {
            position: relative; max-width: 550px; margin: 0 auto;
        }
        .input-group input {
            width: 100%; padding: 22px 30px; border-radius: 20px;
            border: 2px solid #e2e8f0; font-size: 1.2rem; outline: none;
            transition: 0.3s; box-sizing: border-box;
            background: #fdfdfd;
        }
        .input-group input:focus { border-color: var(--emerald-light); box-shadow: 0 0 20px rgba(0, 121, 107, 0.1); }
        
        .btn-glow {
            margin-top: 30px; background: var(--emerald-deep); color: white;
            padding: 18px 60px; border: none; border-radius: 18px;
            font-size: 1.1rem; font-weight: 700; cursor: pointer; transition: 0.4s;
            box-shadow: 0 10px 25px rgba(0, 77, 64, 0.2);
        }
        .btn-glow:hover { background: var(--navy-dark); transform: translateY(-3px); box-shadow: 0 15px 30px rgba(0,0,0,0.15); }

        /* --- Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±Ù (The Podium 2026) --- */
        .podium-wrap { display: flex; justify-content: center; align-items: flex-end; gap: 20px; margin-bottom: 60px; padding-top: 40px; }
        .podium-card {
            background: white; border-radius: 25px; padding: 25px; text-align: center;
            box-shadow: var(--shadow); border: 1px solid #f1f5f9; transition: 0.3s; width: 280px;
        }
        .podium-card:hover { transform: translateY(-5px); }
        .podium-card.first { height: 320px; border: 2px solid var(--gold-muted); z-index: 2; }
        .podium-card.second { height: 280px; }
        .podium-card.third { height: 260px; }
        
        .medal { font-size: 3rem; margin-bottom: 15px; display: block; }
        .podium-card h4 { margin: 10px 0; font-size: 1rem; color: var(--navy-dark); }
        .podium-card .total-score { font-size: 1.8rem; font-weight: 900; color: var(--emerald-deep); }

        /* --- ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨ (The Identity Card) --- */
        .id-badge {
            background: linear-gradient(45deg, var(--navy-dark), var(--emerald-deep));
            color: white; border-radius: 30px; padding: 35px; margin-bottom: 30px;
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px; position: relative; overflow: hidden;
        }
        .id-badge::before {
            content: "\f19d"; font-family: "Font Awesome 6 Free"; font-weight: 900;
            position: absolute; left: -20px; bottom: -20px; font-size: 10rem; opacity: 0.05;
        }
        .id-info label { font-size: 0.85rem; opacity: 0.7; display: block; margin-bottom: 5px; }
        .id-info span { font-size: 1.3rem; font-weight: 700; }

        /* --- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Clean Table) --- */
        .results-box { background: white; border-radius: 30px; overflow: hidden; box-shadow: var(--shadow); }
        table { width: 100%; border-collapse: collapse; }
        th { background: #f8fafc; padding: 20px; text-align: right; color: #475569; font-weight: 700; border-bottom: 1px solid #eee; }
        td { padding: 20px; border-bottom: 1px solid #f1f5f9; font-weight: 500; }
        
        .grade-pill {
            padding: 8px 16px; border-radius: 12px; font-weight: 800; font-size: 0.9rem;
            display: inline-block; min-width: 80px; text-align: center;
        }

        @media (max-width: 768px) {
            .podium-wrap { flex-direction: column; align-items: center; }
            .podium-card { width: 100%; height: auto !important; }
            nav { padding: 1rem 5%; }
        }
    </style>
</head>
<body>

<nav>
    <div class="nav-logo">
        <img src="logo.png" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©">
        <div class="nav-title">
            <h1>Ù…Ø¯Ø±Ø³Ø© ØµÙ„Ø§Ù„Ø© Ø§Ù„Ø´Ø±Ù‚ÙŠØ© (5-10)</h1>
            <span>Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„ØªØ±Ø¨ÙˆÙŠ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</span>
        </div>
    </div>
    <div style="font-size: 1.5rem; color: var(--emerald-deep); cursor: pointer;"><i class="fa-solid fa-bars-staggered"></i></div>
</nav>

<div class="container">
    
    <section id="searchSection" class="view active">
        <div class="search-hero">
            <i class="fa-solid fa-fingerprint" style="font-size: 4rem; color: var(--gold-muted); margin-bottom: 20px;"></i>
            <h2>Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ØªÙ…ÙŠØ² Ø§Ù„Ø±Ù‚Ù…ÙŠØ©</h2>
            <p>Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ø¨Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ù†ÙŠ Ù„Ù„Ø·Ø§Ù„Ø¨ Ù„Ø§Ø³ØªØ¹Ø±Ø§Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ©</p>
            
            <div class="input-group">
                <input type="text" id="civilInput" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ù†ÙŠ">
            </div>
            
            <button class="btn-glow" onclick="executeSearch()">Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ</button>
        </div>
    </section>

    <section id="resultSection" class="view">
        
        <div class="podium-wrap" id="honorPodium">
            </div>

        <div class="id-badge" id="studentDetails">
            </div>

        <div class="results-box">
            <table>
                <thead>
                    <tr>
                        <th>Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</th>
                        <th style="text-align: center;">Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</th>
                        <th style="text-align: center;">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ</th>
                    </tr>
                </thead>
                <tbody id="resultsBody"></tbody>
            </table>
        </div>

        <div style="text-align: center; margin-top: 50px;">
            <button class="btn-glow" style="background: var(--navy-dark);" onclick="location.reload()">Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¬Ø¯ÙŠØ¯</button>
        </div>
    </section>

</div>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
<script src="firebase-config.js"></script>

<script>
    async function executeSearch() {
        const civil = document.getElementById('civilInput').value.trim();
        if(!civil) return alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ù†ÙŠ");

        document.querySelector('.btn-glow').innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...';
        
        const files = ["grade5.json", "grade6.json", "grade7.json", "grade8.json", "grade9.json"];
        let student = null, mates = [];

        for (let f of files) {
            try {
                const res = await fetch(f + "?v=" + Date.now());
                const data = await res.json();
                student = data.find(s => s["Ø±Ù‚Ù…_Ù…Ø¯Ù†ÙŠ"].toString() === civil);
                if(student) {
                    mates = data.filter(m => m["Ø§Ù„ØµÙ"] === student["Ø§Ù„ØµÙ"] && m["Ø§Ù„Ø´Ø¹Ø¨Ø©"] === student["Ø§Ù„Ø´Ø¹Ø¨Ø©"]);
                    break;
                }
            } catch(e) {}
        }

        if(student) {
            buildUI(student, mates);
        } else {
            alert("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ù†ÙŠ");
            document.querySelector('.btn-glow').innerText = 'Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ';
        }
    }

    function buildUI(student, mates) {
        const keys = Object.keys(student).filter(k => !["Ø±Ù‚Ù…_Ù…Ø¯Ù†ÙŠ", "Ø§Ù„Ø§Ø³Ù…", "Ø§Ù„ØµÙ", "Ø§Ù„Ø´Ø¹Ø¨Ø©"].includes(k));
        const calcTotal = (s) => keys.reduce((a, b) => a + parseFloat(s[b] || 0), 0);
        
        const sorted = mates.map(m => ({
            name: m["Ø§Ù„Ø§Ø³Ù…"], total: calcTotal(m), id: m["Ø±Ù‚Ù…_Ù…Ø¯Ù†ÙŠ"]
        })).sort((a,b) => b.total - a.total);

        const rank = sorted.findIndex(s => s.id.toString() === student["Ø±Ù‚Ù…_Ù…Ø¯Ù†ÙŠ"].toString()) + 1;

        // 1. Ø§Ù„Ø£ÙˆØ§Ø¦Ù„
        const top3 = sorted.slice(0, 3);
        const medals = ['ğŸ¥ˆ', 'ğŸ¥‡', 'ğŸ¥‰'];
        const classes = ['second', 'first', 'third'];
        let podHtml = '';
        
        [top3[1], top3[0], top3[2]].forEach((s, i) => {
            if(!s) return;
            const actualIdx = sorted.indexOf(s);
            podHtml += `
                <div class="podium-card ${classes[i]}">
                    <span class="medal">${medals[i]}</span>
                    <h4>${s.name}</h4>
                    <div class="total-score">${s.total}</div>
                    <small style="color:#888">Ø§Ù„Ù…Ø±ÙƒØ² ${actualIdx + 1}</small>
                </div>`;
        });
        document.getElementById('honorPodium').innerHTML = podHtml;

        // 2. ÙƒØ±Øª Ø§Ù„Ù‡ÙˆÙŠØ©
        document.getElementById('studentDetails').innerHTML = `
            <div class="id-info"><label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label><span>${student["Ø§Ù„Ø§Ø³Ù…"]}</span></div>
            <div class="id-info"><label>Ø§Ù„ØµÙ / Ø§Ù„Ø´Ø¹Ø¨Ø©</label><span>${student["Ø§Ù„ØµÙ"]} / ${student["Ø§Ù„Ø´Ø¹Ø¨Ø©"]}</span></div>
            <div class="id-info"><label>Ø§Ù„ØªØ±ØªÙŠØ¨ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø¹Ø¨Ø©</label><span>${rank} Ù…Ù† ${mates.length}</span></div>
            <div class="id-info"><label>Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¹Ø§Ù…</label><span>${(calcTotal(student)/keys.length).toFixed(1)}%</span></div>
        `;

        // 3. Ø§Ù„Ø¬Ø¯ÙˆÙ„
        let tableRows = '';
        keys.forEach(k => {
            const val = parseFloat(student[k]);
            const st = getStatus(val);
            tableRows += `
                <tr>
                    <td style="font-weight:700;">${k}</td>
                    <td style="text-align:center; font-size:1.2rem;">${val}</td>
                    <td style="text-align:center;"><span class="grade-pill" style="background:${st.bg}; color:${st.color}">${st.label}</span></td>
                </tr>`;
        });
        document.getElementById('resultsBody').innerHTML = tableRows;

        document.getElementById('searchSection').classList.remove('active');
        document.getElementById('resultSection').classList.add('active');
    }

    function getStatus(v) {
        if(v >= 90) return { label: 'Ù…Ù…ØªØ§Ø²', color: '#004d40', bg: '#e0f2f1' };
        if(v >= 80) return { label: 'Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹', color: '#0277bd', bg: '#e1f5fe' };
        if(v >= 50) return { label: 'Ù…Ù‚Ø¨ÙˆÙ„', color: '#ef6c00', bg: '#fff3e0' };
        return { label: 'Ø¶Ø¹ÙŠÙ', color: '#c62828', bg: '#ffebee' };
    }

    firebase.auth().onAuthStateChanged(user => { if(!user) window.location="index.html"; });
</script>

</body>
</html>
